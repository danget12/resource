
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Student Exit Exam</title>
  <style>
    body {
      font-family: 'Georgia', serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 0;
      color: #333;
    }
    .container {
      display: flex;
      max-width: 1200px;
      margin: auto;
      padding: 20px;
    }
    .left-panel, .right-panel {
      width: 20%;
      padding: 15px;
      background-color: #f0f4f8;
      border-radius: 6px;
      display: none;
    }
    .main-panel {
      width: 60%;
      background: #fff;
      padding: 30px;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }
    h2, h3, h4 {
      color: #003366;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin: 5px 0 15px;
      font-size: 16px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-family: 'Georgia', serif;
    }
    button {
      background-color: #003366;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #0055a5;
    }
    .timer {
      text-align: right;
      font-weight: bold;
      color: #aa0000;
      margin-bottom: 20px;
    }
    .question-box {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #ccc;
      background-color: #fdfdfd;
      border-radius: 6px;
    }
    .navigation-buttons {
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }
    .question-nav span {
      display: inline-block;
      width: 30px;
      height: 30px;
      line-height: 30px;
      text-align: center;
      margin: 5px;
      border-radius: 4px;
      border: 1px solid #aaa;
      cursor: pointer;
      font-weight: bold;
      color: #003366;
    }
    .question-nav .answered {
      background-color: #cce5ff;
    }
    .question-nav .flagged {
      border: 2px solid red;
    }
    .flag-btn {
      background-color: #ffcc00;
      color: black;
      font-weight: bold;
      width: 100%;
    }
    .review, .summary {
      padding-top: 10px;
    }
    .answer-review {
      margin-top: 10px;
      padding: 10px;
      background-color: #f4f4f4;
      border-radius: 4px;
      border-left: 5px solid #003366;
    }
    .correct { color: green; font-weight: bold; }
    .incorrect { color: red; font-weight: bold; }
  </style>
</head>
<body>
  <div class="container">
    <div class="left-panel" id="leftPanel">
      <button class="flag-btn" onclick="toggleFlag()">Flag/Unflag Question</button>
    </div>
    <div class="main-panel">
      <div id="login" class="login active">
        <h2>Login</h2>
        <select id="department">
          <option value="">Select Department</option>
          <option value="CSE">CSE</option>
          <option value="Management">Management</option>
          <option value="Accounting">Accounting</option>
          <option value="Economics">Economics</option>
        </select>
        <input type="text" id="username" placeholder="Username">
        <input type="password" id="password" placeholder="Password">
        <select id="questionVersion">
          <option value="">Select Question Set</option>
          <option value="v1">Version 1</option>
          <option value="v2">Version 2</option>
        </select>
        <button onclick="login()">Login</button>
      </div>
      <div id="quiz" class="quiz" style="display:none;">
        <div class="timer">Time left: <span id="time">30:00</span></div>
        <div class="question-box" id="questionBox"></div>
        <div class="navigation-buttons">
          <button onclick="prevQuestion()">Previous</button>
          <button onclick="nextQuestion()">Next</button>
        </div>
      </div>
      <div id="summary" class="summary" style="display:none;">
        <h2>Finish Attempt</h2>
        <div id="summaryContent"></div>
        <button onclick="backToAttempt()">Back to Attempt</button>
        <button onclick="confirmSubmit()">Submit</button>
      </div>
      <div id="review" class="review" style="display:none;">
        <h2>Score Review</h2>
        <div id="reviewContent"></div>
        <button onclick="location.reload()">Restart</button>
      </div>
      <div id="adminUpload" class="admin-upload" style="display:none;">
        <h2>Admin Panel</h2>
        <input type="file" id="fileInput"><br>
        <button onclick="uploadQuestions()">Upload Questions</button>
        <hr>
        <h3>Add Student Account</h3>
        <select id="newStudentDept">
          <option value="">Select Department</option>
          <option value="CSE">CSE</option>
          <option value="Management">Management</option>
          <option value="Accounting">Accounting</option>
          <option value="Economics">Economics</option>
        </select>
        <input type="text" id="newStudentUser" placeholder="Student Username">
        <input type="password" id="newStudentPass" placeholder="Student Password">
        <button onclick="addStudent()">Add Student</button>
      </div>
    </div>
    <div class="right-panel" id="rightPanel">
      <h4>Question Navigation</h4>
      <div id="questionNav" class="question-nav"></div>
      <button onclick="showSummary()">Finish Attempt</button>
    </div>
  </div>
<script>
let allQuestions = {
  CSE: {
    v1: [
      { q: "What is HTML?", options: ["Programming", "Markup", "Database", "Protocol"], answer: 1 },
      { q: "2+2?", options: ["3", "4", "5", "6"], answer: 1 }
    ],
    
    v2: [
      { q: "What is HTML v2?", options: ["Programming", "Markup", "Database", "Protocol"], answer: 1 },
      { q: "2+2?", options: ["3", "4", "5", "6"], answer: 1 }
    ]
  },

   Accounting: {
    v1: [
      { q: "What is the primary purpose of financial accounting?", options: ["To track inventory", "To determine profitability", "To calculate taxes", "To provide financial information for decision-making"], answer: 3 },
      { q: "Which of the following is an example of a current liability?", options: ["Accounts payable", "Land", "Equipment", "Long-term debt"], answer: 0 },
      { q: "The matching principle in accounting requires that expenses be matched with:", options: ["Assets", "Liabilities", "Revenues", "Equity"], answer: 2 },
      { q: "Which of the following is considered an operating activity in a cash flow statement?", options: ["Issuing common stock", "Purchasing property", "Selling products", "Borrowing money"], answer: 2 },
      { q: "Which financial statement reports a company's financial position at a specific point in time?", options: ["Income Statement", "Cash Flow Statement", "Balance Sheet", "Statement of Retained Earnings"], answer: 2 },
      { q: "Depreciation is an example of a(n):", options: ["Revenue", "Expense", "Asset", "Liability"], answer: 1 },
      { q: "Which of the following accounts will not be affected by an adjusting entry for unearned revenue?", options: ["Cash", "Revenue", "Unearned Revenue", "Accounts Receivable"], answer: 3 },
      { q: "A company has total assets of $500,000 and total liabilities of $300,000. What is the equity?", options: ["$100,000", "$200,000", "$300,000", "$500,000"], answer: 1 },
      { q: "Which of the following is not part of the owners' equity section of the balance sheet?", options: ["Common stock", "Retained earnings", "Accounts payable", "Additional paid-in capital"], answer: 2 },
      { q: "Which of the following is an example of a non-current asset?", options: ["Cash", "Accounts receivable", "Goodwill", "Inventory"], answer: 2 },
      { q: "Which of the following is an example of an accrual?", options: ["Prepaid expenses", "Interest payable", "Unearned revenue", "Advances from customers"], answer: 1 },
      { q: "In a journal entry, a credit entry to an account increases the balance of a(n):", options: ["Asset", "Liability", "Equity", "Expense"], answer: 1 },
      { q: "What is the purpose of the trial balance?", options: ["To check whether the accounts are in balance", "To prepare the income statement", "To determine tax obligations", "To prepare the balance sheet"], answer: 0 },
      { q: "Which of the following accounts normally has a credit balance?", options: ["Accounts payable", "Accounts receivable", "Inventory", "Cash"], answer: 0 }
    ],
    v2: [
      { q: "Which of the following is a liability?", options: ["Accounts payable", "Inventory", "Land", "Common stock"], answer: 0 },
      { q: "What is the purpose of the statement of cash flows?", options: ["To show the company's profitability", "To show the company's financial position", "To show the sources and uses of cash", "To determine taxes owed"], answer: 2 },
      { q: "Which of the following is an example of an operating activity in the cash flow statement?", options: ["Issuing bonds", "Paying salaries", "Selling equipment", "Buying stock"], answer: 1 },
      { q: "What does the revenue recognition principle state?", options: ["Revenue should be recognized when cash is received", "Revenue should be recognized when the product is sold or service is performed", "Revenue should be recognized at the end of the fiscal year", "Revenue should be recognized when payment is made"], answer: 1 },
      { q: "Which of the following would be classified as a long-term asset?", options: ["Accounts payable", "Equipment", "Inventory", "Cash equivalents"], answer: 1 },
      { q: "Which account appears on both the balance sheet and the income statement?", options: ["Accounts payable", "Cash", "Sales revenue", "Retained earnings"], answer: 3 },
      { q: "The principle of conservatism in accounting suggests that:", options: ["Revenues should be recognized when earned", "Liabilities should not be understated", "Assets should be valued at their market value", "Expenses should not be understated"], answer: 1 },
      { q: "Which of the following is not an example of an intangible asset?", options: ["Patent", "Goodwill", "Trademark", "Land"], answer: 3 },
      { q: "What does the cost principle state?", options: ["Assets should be recorded at their market value", "Assets should be recorded at their historical cost", "Assets should be recorded at their replacement cost", "Assets should be recorded at their fair value"], answer: 1 },
      { q: "Which of the following is a characteristic of the accounting period concept?", options: ["The company must recognize revenue only in the period in which it was earned", "The financial statements should reflect transactions that span the fiscal year", "The company must recognize revenue only after cash is received", "The company can choose any period for reporting"], answer: 0 },
      { q: "What is the main difference between a corporation and a partnership?", options: ["A corporation has unlimited liability, while a partnership has limited liability", "A partnership is taxed at a higher rate than a corporation", "A corporation is a separate legal entity, while a partnership is not", "A partnership has more shareholders than a corporation"], answer: 2 },
      { q: "In which order are financial statements typically prepared?", options: ["Balance sheet, income statement, cash flow statement", "Income statement, cash flow statement, balance sheet", "Cash flow statement, balance sheet, income statement", "Income statement, balance sheet, cash flow statement"], answer: 3 },
      { q: "Which of the following is an example of an asset?", options: ["Accounts payable", "Accounts receivable", "Common stock", "Retained earnings"], answer: 1 },
      { q: "Which of the following represents an increase in stockholders' equity?", options: ["Paying dividends", "Issuing common stock", "Recording depreciation", "Paying off a loan"], answer: 1 }
    ]
  }
};
let studentAccounts = {
  CSE: [{ username: "demo", password: "1234" }], Management: [], Accounting: [ {username: "demo", password: "1234" }], Economics: []
};
let questions = [], current = 0, userAnswers = [], flagged = [], timer, department = "";

function login() {
  department = document.getElementById('department').value;
  let version = document.getElementById('questionVersion').value;
  let u = document.getElementById('username').value;
  let p = document.getElementById('password').value;

  if (u === "admin" && p === "admin123") {
    show('adminUpload');
    document.getElementById('leftPanel').style.display = 'none';
    document.getElementById('rightPanel').style.display = 'none';
    return;
  }

  let valid = studentAccounts[department]?.some(acc => acc.username === u && acc.password === p);
  if (valid && allQuestions[department] && allQuestions[department][version]) {
    questions = allQuestions[department][version];
    userAnswers = Array(questions.length).fill(null);
    flagged = Array(questions.length).fill(false);
    show('quiz');
    document.getElementById('leftPanel').style.display = 'block';
    document.getElementById('rightPanel').style.display = 'block';
    startTimer(30 * 60);
    renderQuestion();
    renderNav();
  } else {
    alert('Invalid credentials or question set not found.');
  }
}

function renderQuestion() {
  const q = questions[current];
  let html = `<h3>Q${current+1}</h3><p>${q.q}</p>`;
  q.options.forEach((opt, i) => {
    html += `<label><input type='radio' name='q' value='${i}' ${userAnswers[current] === i ? 'checked' : ''} onchange='submitAnswer(${i})'> ${opt}</label><br>`;
  });
  document.getElementById('questionBox').innerHTML = html;
  renderNav();
}

function nextQuestion() { if (current < questions.length - 1) { current++; renderQuestion(); } }
function prevQuestion() { if (current > 0) { current--; renderQuestion(); } }
function submitAnswer(val) { userAnswers[current] = val; renderNav(); }

function toggleFlag() { flagged[current] = !flagged[current]; renderNav(); }

function renderNav() {
  let html = '';
  for (let i = 0; i < questions.length; i++) {
    let cls = '';
    if (userAnswers[i] != null) cls += 'answered ';
    if (flagged[i]) cls += 'flagged';
    html += `<span class='${cls}' onclick='goTo(${i})'>${i + 1}</span>`;
  }
  document.getElementById('questionNav').innerHTML = html;
}

function goTo(i) { current = i; renderQuestion(); }
function showSummary() {
  show('summary');
  let html = '';
  questions.forEach((q, i) => {
    html += `<p>Q${i+1}: ${userAnswers[i]!=null?'✅ Answer Seved':'❌ Answer Not Saved'} ${flagged[i]?'🚩':''}</p>`;
  });
  document.getElementById('summaryContent').innerHTML = html;
}
function backToAttempt() { show('quiz'); renderQuestion(); }
function confirmSubmit() { if (confirm("Are you sure you want to submit?")) finishQuiz(); }
function finishQuiz() {
  show('review');
  let score = 0, html = '';
  questions.forEach((q, i) => {
    let ua = userAnswers[i];
    let ca = q.answer;
    if (ua === ca) score++;
    html += `<div class='answer-review'>Q${i+1}: ${q.q}<br> Your: <span class='${ua === ca ? 'correct' : 'incorrect'}'>${q.options[ua] || 'No answer'}</span><br> Correct: <span class='correct'>${q.options[ca]}</span><br></div><hr>`;
  });
  html = `<p>You scored ${score}/${questions.length} (${Math.round(score/questions.length*100)}%)</p>` + html;
  document.getElementById('reviewContent').innerHTML = html;
}

function startTimer(secs) {
  timer = setInterval(() => {
    if (secs <= 0) { clearInterval(timer); finishQuiz(); }
    else {
      let m = Math.floor(secs / 60), s = secs % 60;
      document.getElementById('time').innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
      secs--;
    }
  }, 1000);
}

function uploadQuestions() {
  let file = document.getElementById('fileInput').files[0];
  if (!file) return alert("No file selected.");
  let reader = new FileReader();
  reader.onload = (e) => {
    try {
      allQuestions = JSON.parse(e.target.result);
      alert("Questions uploaded successfully!");
    } catch {
      alert("Invalid JSON format.");
    }
  };
  reader.readAsText(file);
}

function addStudent() {
  let dept = document.getElementById('newStudentDept').value;
  let user = document.getElementById('newStudentUser').value;
  let pass = document.getElementById('newStudentPass').value;

  if (!dept || !user || !pass) {
    alert("Fill all fields.");
    return;
  }
  if (!studentAccounts[dept]) studentAccounts[dept] = [];
  if (studentAccounts[dept].some(s => s.username === user)) {
    alert("Username already exists in that department.");
    return;
  }
  studentAccounts[dept].push({ username: user, password: pass });
  alert("Student added successfully!");
  document.getElementById('newStudentUser').value = "";
  document.getElementById('newStudentPass').value = "";
}

function show(id) {
  ['login', 'quiz', 'summary', 'review', 'adminUpload'].forEach(el => {
    document.getElementById(el).style.display = 'none';
  });
  document.getElementById(id).style.display = 'block';
}
</script>
</body>
</html>
